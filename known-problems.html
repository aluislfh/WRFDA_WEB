<html>

<head>

<title>WRFDA Known Problems and Fixes</title>

<meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1">

<meta name="KEYWORDS" content="meteorology, mesoscale, microscale, weather modeling, forecasting weather, weather prediction, predictability, cloud systems, boundary layers, surface-atmosphere interactions, convective cloud systems, atmospheric chemistry, precipitating weather systems, wildfire research, National Center for Atmospheric Research">

<meta name="DESCRIPTION" content="WRF Mesoscale Model Users homepage">

<meta name="ROBOTS" content="INDEX,FOLLOW">

<meta name="resource-type" content="document">

<meta http-equiv="expires" content="0">

<meta name="author" content="MMM Webmaster">

<meta name="copyright" content="Copyright (c) 2017 by UCAR">

<meta name="revisit-after" content="1 days">

<meta name="distribution" content="Global">

<meta name="rating" content="General">





<SCRIPT language=JavaScript src="scripts/menu_array.js" type=text/javascript></SCRIPT>

<SCRIPT language=JavaScript src="scripts/mmenu.js" type=text/javascript></SCRIPT>





<link href="../images/wrfstyle.css" rel="stylesheet" type="text/css">
<style type="text/css">
<!--
.style2 {
	font-family: Arial, Helvetica, sans-serif;
	font-size: 10pt;
}
.style3 {font-size: 14px}
-->
</style>
<link href="images/wrfstyle.css" rel="stylesheet" type="text/css">
</head>



<body bgcolor="#FFFFFF" background="../images/back2.jpg" link="#000099" vlink="#000099" alink="#FF3300" leftmargin="0" topmargin="0" marginwidth="0" marginheight="0">

<table width="100%" border="0" cellspacing="0" cellpadding="0">

  <tr bgcolor="#000000">

    <td height="10" bgcolor="#000000"><div align="left"><img src="images/transgif.gif" width="1" height="1"></div>

    </td>

  </tr>

  <tr valign="top">

    <td height="10" bgcolor="#DDFFDD"><img src="images/header_new_cropped.png" height="56" border="0"></td>

  </tr>

  <tr bgcolor="#FFCC33">

    <td height="6" background="images/goldrule.jpg" bgcolor="#009933"><img src="images/goldrule.jpg" width="1" height="1"></td>

  </tr>

  <tr>

    <td height="34" bgcolor="#009933">&nbsp;</td>

  </tr>

  <tr>

    <td height="2" bgcolor="#ffcc66"><img src="images/transgif.gif" width="1" height="1"></td>

  </tr>

</table>

<table width="100%" height="89%" border="0" cellpadding="0" cellspacing="0" class="background">

  <tr>

    <td height="1739" valign="top" bgcolor="#CBFFCD"><table width="1000" border="0" cellpadding="0" cellspacing="0">

      <tr valign="top">

        <td width="120" height="1739" bgcolor="#009933"><p>&nbsp;</p>

          <table width="130" border="0" align="center" cellpadding="0" cellspacing="0">

            <tr>
              <p align="center"><a href="support.html" class="leftnavlink">WRFDA community support</a></p>
              <p align="center"><a href="faq.html" class="leftnavlink">Frequently asked questions</a></p>
              <p align="center" style="border-width: 5px;border-style: solid;border-color: #CBFFCD;background-color: #CBFFCD;font-family: Arial; line-height: 10pt; font-size: 9pt; font-weight: bold;">Known problems and solutions</p>
              <p align="center"><a href="requirements.html" class="leftnavlink">System requirements</a></p>
              <p align="center"><a href="wrfhelp.html" class="leftnavlink">About wrfhelp</a></p>
              <p align="center"><a href="wrfnews.html" class="leftnavlink">wrf-news list</a></p>
              <p align="center"><a href="wrfusers.html" class="leftnavlink">wrf-users list</a></p>
              <p align="center"><a href="regist.html" class="leftnavlink">Becoming a registered user</a></p>
              <p align="center"><a href="workshop.html" class="leftnavlink">WRF Workshop</a></p>
              <p align="center"><a href="tutorial.html" class="leftnavlink">WRFDA Tutorials</a></p>
              <p align="center"><a href="usersguide.html" class="leftnavlink">Users' Guide</a></p>
            </tr>
          </table>

          <p>&nbsp;</p>          
          <p>&nbsp;</p></td>

          <td width="660" height="1739" colspan="2" bgcolor="#CBFFCD"><p>&nbsp;</p>
            <p class="pagetitle">Known bugs and solutions (if available)</p>
            <p class="bodytext"><b>NOTE: if you are running WRFDA on the Yellowstone machine and your problem is not listed on this page, <a href="yellowstone.html">click here</a>.</b><br><br></p>
            <p class="bodytext">Before installing WRFDA, ensure your system meets the <a href="requirements.html">minimum requirements</a>. <br></p>
            <p class="bodytext">If your issue is not found on this page, please contact <a href="wrfhelp.html">wrfhelp</a> for assistance.<br><br></p>
            <blockquote>
              <blockquote><ul class="bodytext"><li><a href="#V3_8_1">Version 3.8.1</a></li>
                <li><a href="#V3_8">Version 3.8</a>
                <li><a href="#V3_7_1">Version 3.7.1</a>
                <li><a href="#V3_7">Version 3.7</a>
                  <ul><li><a href="#V3_7_compile">Compilation errors</a></li>
                  <li><a href="#V3_7_run">Run-time errors</a></li>
                  <li><a href="#V3_7_results">Bugs affecting results</a></li>
                  </ul></li>
                <li><a href="#V3_6_1">Version 3.6.1</a></li>
                <li><a href="#V3_6">Version 3.6</a></li>
                  <ul><li><a href="#V3_6_compile">Compilation errors</a></li>
                  <li><a href="#V3_6_run">Run-time errors</a></li>
                  </ul></li>
                <li><a href="#V3_5">Version 3.5</a></li>
                <li><a href="#V3_4">Version 3.4</a></li>
                <li><a href="#V3_3">Older versions</a></li>
                <li><a href="#compilers">Bad compilers</a></li></ul><br></blockquote></blockquote>
            <a name="V3_8_1"></a><p class="pagetitle">WRFDA Version 3.8.1 : Known Problems and Fixes</p>
            <blockquote>
            <h1> "Error in decomposition" when assimilating radiances with CRTM (posted 2017-01-19) </h1>
            <p class="bodytext"><strong>Problem: </strong><br>
               WRFDA fails with the following (or similar) error message:<br><br>
               <code>Fatal error in file: da_eof_decomposition.inc  LINE:      40<br>
                 Error in decomposition, info =    7</code><br></p>
            <p class="bodytext"><strong>Solution:</strong><br>
               This problem is due to pixels not being rejected properly when CRTM has errors calculating the vertical pressure profile.<br>
               In file <code>var/da/da_radiance/da_get_innov_vector_crtm.inc</code>, after line 434, add the following text on its own new line:</p>
               <blockquote><code>iv%instid(inst)%info%proc_domain(:,n) = .false.</code></blockquote>
            <p class="bodytext">This should be just before the line that says "cycle pixel_loop"<br>
               Then re-compile the code. This should properly reject these bad pixels which cause this failure.</p>
            <h1> Precision errors using ifort on Cray machines (posted 2016-09-21) </h1>
            <p class="bodytext"><strong>Problem: </strong><br>
               The WRFPLUS adjoint check fails on Cray machines:<br><br>
               <code>ad_check: VAL_TL: 0.29626592914807E+12 <br>ad_check: VAL_AD: 0.29626592915255E+12<br></code><br>
               This may result in precision problems, including bit-for-bit differences between runs, on affected machines</p>
            <p class="bodytext"><strong>Solution:</strong><br>
               Replace the arch/configure_new.defaults file in your WRFPLUS and/or WRFDA builds with this version: <a href=fixes/v381/configure_new.defaults>configure_new.defaults</a></p>
            <p class="bodytext">After replacing the file, run <code>./clean -a</code> and re-compile WRFPLUS and/or WRFDA.</p>
            </blockquote>
            <a name="V3_8"></a><p class="pagetitle">WRFDA Version 3.8 : Known Problems and Fixes</p>
            <blockquote>
            <h1> "Error in decomposition" when assimilating radiances with CRTM (posted 2017-01-19) </h1>
            <p class="bodytext"><strong>Problem: </strong><br>
               WRFDA fails with the following (or similar) error message:<br><br>
               <code>Fatal error in file: da_eof_decomposition.inc  LINE:      40<br>
                 Error in decomposition, info =    7</code><br></p>
            <p class="bodytext"><strong>Solution:</strong><br>
               This problem is due to pixels not being rejected properly when CRTM has errors calculating the vertical pressure profile.<br>
               In file <code>var/da/da_radiance/da_get_innov_vector_crtm.inc</code>, after line 434, add the following text on its own new line:</p>
               <blockquote><code>iv%instid(inst)%info%proc_domain(:,n) = .false.</code></blockquote>
            <p class="bodytext">This should be just before the line that says "cycle pixel_loop"<br>
               Then re-compile the code. This should properly reject these bad pixels which cause this failure.</p>
            <h1> Compilation error in BUFR libraries (posted 2016-05-15) </h1>
            <p class="bodytext"><strong>Problem: </strong><br>
               BUFR libraries (and therefore <code>da_wrfvar.exe</code>) fail to compile, potentially with the following (or similar) error message:<br><br>
               <code>atrcpt.f:3.1:<br>C$$$  SUBPROGRAM DOCUMENTATION BLOCK<br> 1<br>
                     Fatal Error: Invalid character '$' at (1). Use -fdollar-ok to allow it as an extension</code><br></p>
            <p class="bodytext"><strong>Solution:</strong><br>
               This problem is due to a mistake in the BUFR Makefile, causing variables in the user's environment to be read incorrectly. There are two potential solutions:</p>
               <blockquote><ul class="bodytext"><li>Unset the environment variables "<code>FCFLAGS</code>" and/or "<code>FORMAT_FIXED</code>"</li>
                   <li>Replace the file <code>var/external/bufr/Makefile</code> with this version: (<a href="fixes/v38/bufr/Makefile">Makefile</a>)</li></ul></blockquote>
            <p class="bodytext">After applying either above solution, run <code>./clean -a</code> and re-compile WRFDA.</p>
            <h1> Segmentation fault when running 4DVAR with RRTMG physics (posted 2016-05-15) </h1>
            <p class="bodytext"><strong>Problem: </strong><br>
               Code crashes when running WRFDA-4DVAR with <code>ra_lw_physics=4</code> and/or <code>ra_sw_physics=4</code>.<br>
            <p class="bodytext"><strong>Solution:</strong><br>
               Replace the file WRFPLUSV3/phys/module_ra_cam_support.F with this copy: (<a href="fixes/v38/module_ra_cam_support.F">module_ra_cam_support.F</a>). Then re-compile WRFPLUS and WRFDA (in that order).</p>
            </blockquote>
            <a name="V3_7_1"></a><p class="pagetitle">WRFDA Version 3.7.1 : Known Problems and Fixes</p>
            <blockquote>
            <h1> "Error in decomposition" when assimilating radiances with CRTM (posted 2017-01-19) </h1>
            <p class="bodytext"><strong>Problem: </strong><br>
               WRFDA fails with the following (or similar) error message:<br><br>
               <code>Fatal error in file: da_eof_decomposition.inc  LINE:      40<br>
                 Error in decomposition, info =    7</code><br></p>
            <p class="bodytext"><strong>Solution:</strong><br>
               This problem is due to pixels not being rejected properly when CRTM has errors calculating the vertical pressure profile.<br>
               In file <code>var/da/da_radiance/da_get_innov_vector_crtm.inc</code>, after line 434, add the following text on its own new line:</p>
               <blockquote><code>iv%instid(inst)%info%proc_domain(:,n) = .false.</code></blockquote>
            <p class="bodytext">This should be just before the line that says "cycle pixel_loop"<br>
               Then re-compile the code. This should properly reject these bad pixels which cause this failure.</p>
            <h1> Error for large domains of certain sizes (posted 2016-12-07)</h1>
            <p class="bodytext"><strong>Problem: </strong><br>
               WRFDA fails with the error message:<br>
               <code>Fatal error in file: &lt;A HREF="http://www.mmm.ucar.edu/people/wrfhelp/wrfvar/code/trunk/da_setup_runconstants.html">da_setup_runconstants.inc&lt;/a>  LINE:      54<br>No factor found<br></code>
            <p class="bodytext"><strong>Solution:</strong><br>
               This error can seen when running WRFDA for large domains of certain sizes, due to the way WRFDA's FFT routines work. In the file <kbd>var/da/da_setup_structures/da_setup_runconstants.inc</kbd>, change "nrange" as defined in the beginning of the program from "60" to "1000", then recompile the code. This should allow WRFDA to work for very large domains, up to tens of thousands of grid points across.</p>
            <h1> Error using VARBC for IASI (posted 2016-04-06) </h1>
            <p class="bodytext"><strong>Problem: </strong><br>
               Code crashes when using Variational Bias Correction for IASI instrument<br>
            <p class="bodytext"><strong>Solution:</strong><br>
               This problem is due to incorrect entries in the default VARBC.in file; use this version instead: (<a href="fixes/v371/VARBC.in">VARBC.in</a>)</p>
            <h1> Failure to compile with RTTOV 11.3 (posted 2015-10-14) </h1>
            <p class="bodytext"><strong>Problem: </strong><br>
               When using RTTOV 11.3, WRFDA fails to compile with an error message beginning with:<br><br>
               <code>Can not find a compatible RTTOV library!</code><br></p>
            <p class="bodytext"><strong>Solution:</strong><br>
               Replace the file <code>WRFDA/compile</code> with this copy: (<a href="fixes/v371/compile">compile</a>). Then run "<code>./clean -a</code>" and recompile.</p>
            <h1> Bad results with new cv_options=7 background error option (posted 2015-12-09) </h1>
            <p class="bodytext"><strong>Problem: </strong><br>
               GEN_BE has a bug for the new <kbd>cv_options=7</kbd> option that produces incorrect statistics for some control variables in <kbd>be.dat</kbd>.</p>
            <p class="bodytext"><strong>Solution:</strong><br>
               As a quick fix for version 3.7.1: Replace the script <code>WRFDA/var/scripts/gen_be/gen_be.ksh</code> with this copy: (<a href="fixes/v37/gen_be.ksh">gen_be.ksh</a>). There is no need to recompile WRFDA; the new script will be read properly at run time. When the next version of WRFDA (3.8) is released, we <b>highly</b> recommend using that version if you plan on using the CV7 GEN_BE option.</p>
            </blockquote>
            <a name="V3_7"></a><p class="pagetitle">WRFDA Version 3.7 : Known Problems and Fixes</p>
            <blockquote>
            <p style="padding-right: 45px;padding-left: 60px;"><table width="100%" border="1" class="bodytable" style="background-color:white;"><tr><td style="text-align:center"><b>NOTE:</b> It is strongly recommended that you <b>not</b> use wrfinput files created with WRF version 3.7, which have problems with the initial wind field when generated from GFS or FNL input. Either upgrade to WRF version 3.7.1 or apply the fix mentioned on the <a href="http://www2.mmm.ucar.edu/wrf/users/wrfv3.7/known-prob-3.7.html">WRF Known Problems page</a> under "Input/Boundary Data".</td></tr></table></p>
            <a name="V3_7_compile"><p class="pagetitle">Compilation Errors</p>
            <h1> "Error in decomposition" when assimilating radiances with CRTM (posted 2017-01-19) </h1>
            <p class="bodytext"><strong>Problem: </strong><br>
               WRFDA fails with the following (or similar) error message:<br><br>
               <code>Fatal error in file: da_eof_decomposition.inc  LINE:      40<br>
                 Error in decomposition, info =    7</code><br></p>
            <p class="bodytext"><strong>Solution:</strong><br>
               This problem is due to pixels not being rejected properly when CRTM has errors calculating the vertical pressure profile.<br>
               In file <code>var/da/da_radiance/da_get_innov_vector_crtm.inc</code>, after line 434, add the following text on its own new line:</p>
               <blockquote><code>iv%instid(inst)%info%proc_domain(:,n) = .false.</code></blockquote>
            <p class="bodytext">This should be just before the line that says "cycle pixel_loop"<br>
               Then re-compile the code. This should properly reject these bad pixels which cause this failure.</p>
            <h1> Problems with PGI compilers (posted 2015-04-21) </h1>
            <p class="bodytext"><strong>Problem: </strong><br>
               There are several known issues with WRFDA compiled with PGI compilers:</p>
               <blockquote><ul class="bodytext"><li>Certain 4DVAR tests fail</li>
                   <li>Bit-for-bit reproducability errors with PGI version 13.3, 13.9, and possibly others</li>
                   <li>PGI version 14+: 4DVAR compilation fails</li></ul></blockquote>
            <p class="bodytext"><strong>No solution available at this time; use another compiler if possible</strong></p>
            <a name="V3_7_run"><p class="pagetitle">Run-time Errors</p>
            <h1> Error for large domains of certain sizes (posted 2016-12-07)</h1>
            <p class="bodytext"><strong>Problem: </strong><br>
               WRFDA fails with the error message:<br>
               <code>Fatal error in file: &lt;A HREF="http://www.mmm.ucar.edu/people/wrfhelp/wrfvar/code/trunk/da_setup_runconstants.html">da_setup_runconstants.inc&lt;/a>  LINE:      54<br>No factor found<br></code>
            <p class="bodytext"><strong>Solution:</strong><br>
               This error can seen when running WRFDA for large domains of certain sizes, due to the way WRFDA's FFT routines work. In the file <kbd>var/da/da_setup_structures/da_setup_runconstants.inc</kbd>, change "nrange" as defined in the beginning of the program from "60" to "1000", then recompile the code. This should allow WRFDA to work for very large domains, up to tens of thousands of grid points across.</p>
            <h1> Errors and bad results with the "rttov_emis_atlas_ir" option (posted 2015-08-12) </h1>
            <p class="bodytext"><strong>Problem: </strong><br>
               For 4DVAR radiance assimilation with RTTOV, using the <kbd>rttov_emis_atlas_ir=1</kbd> option can cause WRFDA to crash, and even if it does not crash the results are likely bad.</p>
            <p class="bodytext"><strong>Solution:</strong><br>
               Replace the file <code>WRFDA/var/da/da_radiance/da_get_innov_vector_rttov.inc</code> with this copy: (<a href="fixes/v37/da_get_innov_vector_rttov.inc">da_get_innov_vector_rttov.inc</a>). Then recompile WRFDA.</p>
            <a name="V3_7_results"><p class="pagetitle">Bugs affecting results</p>
            <h1> Bad results with new "use_radar_rqv" option (posted 2015-05-19) </h1>
            <p class="bodytext"><strong>Problem: </strong><br>
               In certain weather regimes (especially tropical), radar assimilation with <kbd>use_radar_rqv=.true.</kbd> will incorrectly result in no clouds.</p>
            <p class="bodytext"><strong>Solution:</strong><br>
               Replace the file <code>WRFDA/var/da/da_radar/da_get_innov_vector_radar.inc</code> with this copy: (<a href="fixes/v37/da_get_innov_vector_radar.inc">da_get_innov_vector_radar.inc</a>). Then recompile WRFDA.</p>
            <h1> Bad results with new cv_options=7 background error option (posted 2015-12-09) </h1>
            <p class="bodytext"><strong>Problem: </strong><br>
               GEN_BE has a bug for the new <kbd>cv_options=7</kbd> option that produces incorrect statistics for some control variables in <kbd>be.dat</kbd>.</p>
            <p class="bodytext"><strong>Solution:</strong><br>
               As a quick fix for version 3.7: Replace the script <code>WRFDA/var/scripts/gen_be/gen_be.ksh</code> with this copy: (<a href="fixes/v37/gen_be.ksh">gen_be.ksh</a>). There is no need to recompile WRFDA; the new script will be read properly at run time. When the next version of WRFDA (3.8) is released, we <b>highly</b> recommend using that version if you plan on using the CV7 GEN_BE option.</p>
            </blockquote>
            <a name="V3_6_1"></a><p class="pagetitle">WRFDA Version 3.6.1 : Known Problems and Fixes</p>
            <blockquote>
            <h1> Error for large domains of certain sizes (posted 2016-12-07)</h1>
            <p class="bodytext"><strong>Problem: </strong><br>
               WRFDA fails with the error message:<br>
               <code>Fatal error in file: &lt;A HREF="http://www.mmm.ucar.edu/people/wrfhelp/wrfvar/code/trunk/da_setup_runconstants.html">da_setup_runconstants.inc&lt;/a>  LINE:      54<br>No factor found<br></code>
            <p class="bodytext"><strong>Solution:</strong><br>
               This error can seen when running WRFDA for large domains of certain sizes, due to the way WRFDA's FFT routines work. In the file <kbd>var/da/da_setup_structures/da_setup_runconstants.inc</kbd>, change "nrange" as defined in the beginning of the program from "60" to "1000", then recompile the code. This should allow WRFDA to work for very large domains, up to tens of thousands of grid points across.</p>
            <h1> Failure to compile with RTTOV 11.2 (posted 2014-10-17) </h1>
            <p class="bodytext"><strong>Problem: </strong><br>
               When using RTTOV 11.2, WRFDA fails to compile with the following (or similar) error message:<br><br>
               <code>ld: cannot find -lrttov11.1.0_coef_io</code><br></p>
            <p class="bodytext"><strong>Solution:</strong><br>
               Replace the file <code>WRFDA/compile</code> with this copy: (<a href="fixes/v361/compile">compile</a>). Then run "<code>./clean -a</code>" and recompile.</p>
            </blockquote>
            <a name="V3_6"></a><p class="pagetitle">WRFDA Version 3.6 : Known Problems and Fixes</p>
            <blockquote>
            <a name="V3_6_compile"><p class="pagetitle">Compilation Errors</p>
            <h1> Failure to compile with RTTOV 11.2 (posted 2014-10-17) </h1>
            <p class="bodytext"><strong>Problem: </strong><br>
               When using RTTOV 11.2, WRFDA fails to compile with the following (or similar) error message:<br><br>
               <code>ld: cannot find -lrttov11.1.0_coef_io</code><br></p>
            <p class="bodytext"><strong>Solution:</strong><br>
               Replace the file <code>WRFDA/compile</code> with this copy: (<a href="fixes/v36/compile">compile</a>). Then run "<code>./clean -a</code>" and recompile.</p>
            <h1> "Unable to open MODULE file da_grid_definitions.mod" (posted 2014-07-23) </h1>
            <p class="bodytext"><strong>Problem: </strong><br>
               WRFDA fails to compile with the following (or similar) error message:<br><br>
               <code>Unable to open MODULE file da_grid_definitions.mod</code><br></p>
            <p class="bodytext"><strong>Solution:</strong><br>
               Replace the file <code>WRFDA/var/build/depend.txt</code> with this copy: (<a href="fixes/v36/depend.txt">depend.txt</a>). Then run "<code>./clean -a</code>" and recompile.</p>
            <h1> Problems compiling on Mac OS X 10.9 (Mavericks) and potentially other systems (posted 2014-05-27) </h1>
            <p class="bodytext"><strong>Problem: </strong><br>
               WRFDA fails to compile, returning the following message at or near the end of the compilation log:<br><br>
               <code>Undefined symbols for architecture x86_64:<br>
               &nbsp; "_irev_", referenced from:<br>
               &nbsp; &nbsp; &nbsp; _ipkm_ in libbufr.a(ipkm.o)<br>
               &nbsp; &nbsp; &nbsp; _pkb_ in libbufr.a(pkb.o)<br>
               &nbsp; &nbsp; &nbsp; _pkc_ in libbufr.a(pkc.o)<br>
               &nbsp; &nbsp; &nbsp; _iupm_ in libbufr.a(iupm.o)<br>
               &nbsp; &nbsp; &nbsp; _upbb_ in libbufr.a(upbb.o)<br>
               &nbsp; "_wrdlen_", referenced from:<br>
               &nbsp; &nbsp; &nbsp; _openbf_ in libbufr.a(openbf.o)<br>
               &nbsp; &nbsp; &nbsp; _iupbs01_ in libbufr.a(iupbs01.o)<br>
               &nbsp; &nbsp; &nbsp; _iupbs3_ in libbufr.a(iupbs3.o)<br>
               ld: symbol(s) not found for architecture x86_64<br>
               collect2: error: ld returned 1 exit status<br>
               make[2]: [obsproc.exe] Error 1 (ignored)<br></code></p>
            <p class="bodytext"><strong>Solution:</strong><br>
               Please download and untar the following tar file (<a href="fixes/v36/bufr.tar">bufr.tar</a>), which contains a directory named "bufr". Delete the directory "WRFDA/var/external/bufr" and replace it with the new "bufr" directory. Then run "<code>./clean -a</code>" and recompile.</p>
            <h1> Problems compiling with PGI fortran (posted 2014-05-02, updated 2014-07-27) </h1>
            <p class="bodytext"><strong>Problem: </strong><br>
               Compilation fails with the message "PGF90-S-0155-Kind type parameter component does not have a corresponding type parameter specifier - n_layers (NLTECoeff_Define.f90: 125)". This specific error has been seen in PGI version 13.3 and 13.6.</p>
            <p class="bodytext"><strong>Solution:</strong><br>
               Replace the file "WRFDA/var/external/crtm_2.1.3/libsrc/NLTECoeff_Define.f90" with this copy: (<a href="fixes/v36/NLTECoeff_Define.f90">NLTECoeff_Define.f90</a>). Then run "<code>./clean -a</code>" and recompile.</p>
            <p class="bodytext"><strong>Problem: </strong><br>
               Compilation with version 12.5 fails with internal compiler error<br>Compilation with version 13.9 fails with assembler error</p>
            <p class="bodytext"><b>These are problems with the pgf90 compiler itself; we do not have a fix at this time.</b>


            <a name="V3_6_run"><p class="pagetitle">Run-time Errors</p>
            <h1> Error for large domains of certain sizes (posted 2016-12-07)</h1>
            <p class="bodytext"><strong>Problem: </strong><br>
               WRFDA fails with the error message:<br>
               <code>Fatal error in file: &lt;A HREF="http://www.mmm.ucar.edu/people/wrfhelp/wrfvar/code/trunk/da_setup_runconstants.html">da_setup_runconstants.inc&lt;/a>  LINE:      54<br>No factor found<br></code>
            <p class="bodytext"><strong>Solution:</strong><br>
               This error can seen when running WRFDA for large domains of certain sizes, due to the way WRFDA's FFT routines work. In the file <kbd>var/da/da_setup_structures/da_setup_runconstants.inc</kbd>, change "nrange" as defined in the beginning of the program from "60" to "1000", then recompile the code. This should allow WRFDA to work for very large domains, up to tens of thousands of grid points across.</p>
            <h1> Error writing final output when assimilating PREPBUFR data (posted 2014-08-08) </h1>
            <p class="bodytext"><strong>Problem: </strong><br>
             WRFDA fails after the minimization step with the following error:<br><br>
             <code>&nbsp;---------------------------- FATAL ERROR -----------------------<br>
             &nbsp;Fatal error in file: &lt;A HREF="http://www2.mmm.ucar.edu/people/wrfhelp/wrfvar/cod<br>
             &nbsp;e/trunk/da_read_omb_tmp.html"&gt;da_read_omb_tmp.inc&lt;/a&gt; &nbsp;LINE: &nbsp; &nbsp; 412<br>
             &nbsp;Got unknown obs_type string: &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 1 on unit &nbsp;26<br>
             &nbsp;----------------------------------------------------------------<br>
             wrf_abort</code><br><br>
             This error may be seen when assimilating PREPBUFR data. The error has only been seen when running serially, but it may occur in parallel runs as well.</p>
            <p class="bodytext"><strong>Solution:</strong><br>
             Replace the file "WRFDA/var/da/da_obs_io/da_read_obs_bufr.inc" with this copy: (<a href="fixes/v36/da_read_obs_bufr.inc">da_read_obs_bufr.inc</a>). Then run "<code>./clean -a</code>" and recompile.</p>
            <h1> Problems with 4DVAR radiance assimilation using RTTOV (posted 2014-07-27) </h1>
            <p class="bodytext"><strong>Problem: </strong><br>
             Assimilation fails while calculating innovation vector. May either fail with an error ("profile deallocation error"), a segmentation fault or hang indefinitely. Last message printed to the rsl.out files is usually "Calculate innovation vector(iv)" or messages related to "VARBC".</p>
            <p class="bodytext"><strong>Solution:</strong><br>
             Replace the file "WRFDA/var/da/da_radiance/da_get_innov_vector_rttov.inc" with this copy: (<a href="fixes/v36/da_get_innov_vector_rttov.inc">da_get_innov_vector_rttov.inc</a>). Then run "<code>./clean -a</code>" and recompile.</p>
            <h1> Problems reading LITTLE_R files in OBSPROC (posted 2014-06-23) </h1>
            <p class="bodytext"><strong>Problem: </strong><br>
               OBSPROC fails to read LITTLE_R files, with one of the following (or similar) error messages:<br><br>
               <code>forrtl: severe (64): input conversion error, unit -5, file Internal Formatted Read<br>
               Fortran runtime error: Bad value during integer read<br>
               PGFIO-F-231/formatted read/internal file/error on data conversion.</code><br></p>
            <p class="bodytext"><strong>Solution:</strong><br>
               Download and untar the following tar file (<a href="fixes/v36/obsproc.tar">obsproc.tar</a>), which contains a directory named "obsproc". Delete the directory "WRFDA/var/obsproc" and replace it with the new "obsproc" directory. Then run "<code>./clean -a</code>" and recompile.</p>
            <h1> Problems with SEVIRI radiance assimilation (posted 2014-05-16) </h1>
            <p class="bodytext"><strong>Problem: </strong><br>
               WRFDA fails when SEVIRI data is assimilated. May either fail with an error such as a segmentation fault or hang indefinitely.</p>
            <p class="bodytext"><strong>Solution:</strong><br>
               Replace the following two files: </p>
               <blockquote><ul class="bodytext"><li>"WRFDA/var/da/da_obs_io/da_read_y_unit.inc" with this copy: (<a href="fixes/v36/da_read_y_unit.inc">da_read_y_unit.inc</a>).</li>
               <li>"WRFDA/var/da/da_radiance/da_read_obs_bufrseviri.inc" with this copy: (<a href="fixes/v36/da_read_obs_bufrseviri.inc">da_read_obs_bufrseviri.inc</a>).</li></ul></blockquote>
            <p class="bodytext">Then run "<code>./clean -a</code>" and recompile.</p>
            </blockquote>


            <a name="V3_5"></a><p class="pagetitle">WRFDA Version 3.5 : Known Problems and Fixes</p>
            <blockquote>
            <h1> Error for large domains of certain sizes (posted 2016-12-07)</h1>
            <p class="bodytext"><strong>Problem: </strong><br>
               WRFDA fails with the error message:<br>
               <code>Fatal error in file: &lt;A HREF="http://www.mmm.ucar.edu/people/wrfhelp/wrfvar/code/trunk/da_setup_runconstants.html">da_setup_runconstants.inc&lt;/a>  LINE:      54<br>No factor found<br></code>
            <p class="bodytext"><strong>Solution:</strong><br>
               This error can seen when running WRFDA for large domains of certain sizes, due to the way WRFDA's FFT routines work. In the file <kbd>var/da/da_setup_structures/da_setup_runconstants.inc</kbd>, change "nrange" as defined in the beginning of the program from "60" to "1000", then recompile the code. This should allow WRFDA to work for very large domains, up to tens of thousands of grid points across.</p>
            <h1> Compilation failure on IBM AIX platforms (posted 2015-01-14) </h1>
            <p class="bodytext"><strong>Problem: </strong><br>
               Compilation of BUFR libraries fail on IBM AIX platforms using the cc_r C compiler, with the following message:<br><br>
               <code>bort_exit.o: not found<br><br>
               make: The error code from the last command is 1.<br>
               make: Ignored error code 1 from last command.<br>
               &nbsp; &nbsp; cc_r -o bort_exit.o -c -DNOUNDERSCORE&nbsp; -DMAX_HISTORY=25 -DNMM_CORE=0 -DUNDERSCORE bort_exit.c</code></p>
            <p class="bodytext"><strong>Solution:</strong><br>
               Replace the file "var/external/bufr/Makefile" with this copy: (<a href="fixes/v35/Makefile">Makefile</a>). Then run "<code>./clean -a</code>" and recompile.
            <h1> WRFPLUS fails to compile with serial option is selected (posted 2014-01-30) </h1>
            <p class="bodytext"><strong>Problem: </strong><br>
               Compilation of WRFPLUS fails at main/module_wrf_top.f90 with message "error #6404: This name does not have a type, and must have an explicit type." (or similar error message)</p>
            <p class="bodytext"><strong>Solution:</strong><br>
               Replace the file "main/module_wrf_top.F" with this copy: (<a href="fixes/v35/module_wrf_top.F">module_wrf_top.F</a>). Then run "<code>./clean -a</code>" and recompile WRFPLUS.
            <h1> WRFDA compilation problem with some older compilers (posted 2013-04-29) </h1>
            <p class="bodytext"><strong>Problem: </strong><br>
               Compilation fails with the message "Error: Too many digits in STOP code at (1)"</p>
            <p class="bodytext"><strong>Solution:</strong><br>
               Replace the file "var/da/da_radiance/da_read_obs_bufratms.inc" with this copy: (<a href="fixes/v35/da_read_obs_bufratms.inc">da_read_obs_bufratms.inc</a>). Then run "<code>./clean -a</code>" and recompile.
            <h1> Problem reading BUFR or PREPBUFR files (posted 2009-04-09) </h1>
            <p class="bodytext"><strong>Problem: </strong><br>
               WRFDA 3.5 or earlier compiled with gfortran or ifort returns the following error message when trying to read a BUFR or PREPBUFR file:<br><br>
               **************BUFR ARCHIVE LIBRARY ABORT*****************<br>
               BUFRLIB: OPENBF - ERROR READING INPUT FILE CONNECTED TO UNIT 26<br>
               WHEN CHECKING FOR 'BUFR' IN FIRST 4 BYTES OF RECORD<br>
               **************BUFR ARCHIVE LIBRARY ABORT*****************</p>
            <p class="bodytext"><strong>Solution:</strong><br>
               See our page on <a href="readBUFR.html">Reading BUFR files</a></p>
            </blockquote>
            <a name="V3_4"></a><p class="pagetitle">WRFDA Version 3.4 : Known Problems and Fixes</p>
            <blockquote>
            <h1> gfortran "Graphite loop optimizations" error (posted 2015-05-18) </h1>
            <p class="bodytext"><strong>Problem: </strong><br>
               WRFDA fails to compile: gfortran gives the message "sorry, unimplemented: Graphite loop optimizations can only be used if the libcloog-ppl0 package is installed"</p>
            <p class="bodytext"><strong>Solution:</strong><br>
                After running the configuration script (<code>./configure wrfda</code>) edit the "<code>configure.wrf</code>" file to remove the text "-ftree-loop-linear" at or near line 115 (where the variable "FCOPTIM" is defined). Then compile WRFDA.</p>
            <h1> Problem with WRFPLUS under certain "mp_physics" settings (posted 2012-07-24) </h1>
            <p class="bodytext"><strong>Problem: </strong><br>
               WRFPlus adjoint model fails with a segmentation fault or a fatal error message "<code>subscript out of range for array head_grid%g_moist (mediation_pertmod_io.f90: 428)</code>" when <code>mp_physics =</code> any of the following: 9,10,13,14,16,17, or 18.</p>
            <p class="bodytext"><strong>Solution:</strong><br>
               Download and unpack <a href="fixes/v34/Registry.EM_COMMON.tar.gz">Registry.EM_COMMON.tar.gz</a>, and use this file to overwrite the <kbd>WRFPLUS/Registry/Registry.EM_COMMON</kbd> file. Then run "<code>./clean -a</code>" and recompile.</p>
            <h1> Problem reading BUFR or PREPBUFR files (posted 2009-04-09) </h1>
            <p class="bodytext"><strong>Problem: </strong><br>
               WRFDA 3.5 or earlier compiled with gfortran or ifort returns the following error message when trying to read a BUFR or PREPBUFR file:<br><br>
               **************BUFR ARCHIVE LIBRARY ABORT*****************<br>
               BUFRLIB: OPENBF - ERROR READING INPUT FILE CONNECTED TO UNIT 26<br>
               WHEN CHECKING FOR 'BUFR' IN FIRST 4 BYTES OF RECORD<br>
               **************BUFR ARCHIVE LIBRARY ABORT*****************</p>
            <p class="bodytext"><strong>Solution:</strong><br>
               See our page on <a href="readBUFR.html">Reading BUFR files</a></p>
            </blockquote>
            <a name="V3_3"><a name="V3_2"><a name="V3_1"><a name="V3_0"></a><p class="pagetitle">Older versions</p>
            <p style="padding-right: 45px;padding-left: 60px;"><table width="100%" border="1" class="bodytable" style="background-color:white;"><tr><td style="text-align:center"><b>NOTE:</b> It is strongly recommended that you use the most recent version of WRFDA. Versions older than 3.3 are very outdated, have many bugs (even those not listed), and are no longer supported.</td></tr></table></p>
            <blockquote>
            <p class="bodytext">For posterity and reference, known problems with older versions can be found at <a href=known-problems-old.html>this page</a>.</p>
            </blockquote>
            <a name="compilers"></a><p class="pagetitle">Bad compilers</p>
            <blockquote>
              <p class="bodytext">The following compilers have bugs that will cause some or all versions WRFDA and/or WRFPLUS to fail. If no solution is listed, you must update/downgrade to a different compiler version, or use a different compiler.</p>
            <p class="bodytext">Be sure your compiler meets the <a href="requirements.html#compilers">minimum requirements</a>. <br></p>
            <h1>Intel (ifort)</h1>
              <ul class="bodytext">
                <li>Intel (ifort) version 15.0.0 
                  <ul><li><em>No solution at this time</em></li></ul></li>
                <li>Intel (ifort) version 14.0.2 (<a href="https://software.intel.com/en-us/forums/topic/506826">details</a>).
                  <ul><li>Reducing the optimization in the <code>configure.wrf</code> file may solve this problem. Change the line "<code>FCOPTIM &nbsp; &nbsp; &nbsp; &nbsp; = &nbsp; &nbsp; &nbsp; -O3</code>" so that it instead reads "-O2" or "-O1" (note that this is a capital letter "O", not a zero)</li></ul></li>
                <li>Intel (ifort) version 11.1 (<a href="https://software.intel.com/en-us/forums/topic/269937">details</a>).
                  <ul><li><em>No solution at this time</em></li></ul></li></ul>
            <h1>PGI (pgf90)</h1>
              <ul class="bodytext">
                <li>PGI (pgf90); all versions:
                  <ul><li>In the files "var/external/crtm_2.1.3/configure/pgf90.setup" and "var/external/crtm_2.1.3/configure/pgi.setup", delete lines that say "-fast \". Then run "<code>./clean -a</code>" and recompile.</li></ul></li>
                <li>PGI (pgf90) versions 12.5, 13.9
                  <ul><li><em>No solution at this time</em></li></ul></li>
              <p>&nbsp;</p>
            </blockquote>            <p align="center" class="detailtextRed"> 
              <script language="JavaScript">

<!--

document.write("updated " + document.lastModified);

// -->

                        </script>
              <br>
              <br>
            </p></td>
        </tr>

      <tr valign="top">

          <td height="2" colspan="3" bgcolor="#FFCC66"><img src="images/transgif.gif" width="1" height="1"><img src="images/shim162.gif" width="162" height="1"></td>
        </tr>

    </table></td>
  </tr>


  <tr>

    <td height="50" bgcolor="#009933" class="detailtext">&nbsp;</td>
  </tr>
</table>

</body>

</html>

