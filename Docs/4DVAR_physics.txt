2. The Simplified Physics Package

The goal of the simplified physics package is to represent first-order physical effects on the model evolution while also minimizing the code length to make developing its adjoint simple, and to allow the code to run quickly in the iterations required to minimize the cost function. The three areas of physics chosen for maximum impact on the solution, compared to a no-physics model, were surface friction, cumulus parameterization, and large-scale condensation. Here we describe the basic principles of the schemes specifically added for this purpose to WRF-4DVar.

2.1 Surface friction

It is important to represent friction for a realistic representation of the surface wind speed and direction that would allow assimilation of surface wind observations. A full planetary boundary layer (PBL) scheme is usually made complex by the need to handle surface heat and moisture fluxes in the convective boundary layer, and has sophisticated treatments of the gross effects of large eddies as the PBL develops. Without the heat flux included in the simplified physics, the primary role of the boundary layer scheme is to include frictional effects, so an alternative to developing a full PBL scheme adjoint is developed here.

The implementation adopted for the simplified physics package is built on the vertical diffusion code of the model. The surface stress is computed using a constant drag coefficient (0.01 for land, 0.001 for water, 0.003 for coastal points). Instead of applying the full stress at the lowest model level, it is applied using a linearly decreasing function of height that goes to zero at 1 kilometer, approximately representing the vertical distribution effect of boundary-layer eddy fluxes. This distributed stress term is simply added to the vertical diffusion term in the model.

2.2 Cumulus parameterization

The adjoint model is usually run at coarse horizontal resolutions > 10 km requiring a representation of deep convective transports to remove instability and produce rainfall with a reasonably fast time scale. The lack of such a scheme would severely delay and distort the convective rainfall’s time dependence. Most existing cumulus schemes are highly complex codes with many conditional statements to determine instability, updraft mass fluxes, entrainment, detrainment, cloud base, cloud top, triggering, rainfall evaporation, and downdrafts.

The philosophy of the simplified scheme was to reduce the code as much as possible but still include the basic concepts listed above. The final code was only about 150 lines in length, several times shorter than most current state-of-the-science schemes. A unique aspect of this scheme is that within a column, each origin level is evaluated independently, and the total mass flux and other column effects are a simple sum of these origin-level parcels. Each parcel that passes tests to form a buoyant updraft is associated with a cloud top using undiluted ascent to a level of neutral buoyancy based on the parcel moist static energy and environment’s saturated moist static energy. The parcels independently also detrain at their own cloud top. Their mass flux is just proportional to the mass of their origin level. In a similar way, the compensating environmental subsidence effects for these parcels are also additive. The subsidence compensates for the parcel mass flux, and thus exists between the origin level and cloud top, so that the grid column has no net mass flux. It is a downward flux of environmental heat and moisture that generally leads to warming and drying, adding to the detrainment effect at cloud top. Each parcel updraft also produces condensate at each saturated level. These are summed down from cloud top as rainfall. The rain is also allowed to evaporate below cloud base leading to a moistening and cooling effect at those levels, crudely representing the surface thunderstorm outflow, and the remaining rain at the surface is convective rainfall. As noted, the origin-level loop encompasses all of these updraft, detrainment, subsidence, and rainfall evaporation processes with each buoyant parcel in a column simply adding its effects to the others.

2.3 Large-scale condensation

Grid-scale condensational latent heating is represented by a large-scale condensation parameterization. In current models, this is usually part of a sophisticated microphysics scheme that also would include many microphysical processes related to several particle species and their sedimentation. Developing the adjoint of such schemes is made prohibitive by their use of many exponential functions to represent these processes. These models also have a significant cost associated with advecting the microphysical species. The large-scale condensation approach only needs to advect water vapor, and carries no cloud or precipitation variables.

The simplified module here employs a traditional approach used in models such as MM4 prior to the development of microphysical schemes. When used with large grid sizes, it is typical to take 90% relative humidity as the upper limit beyond which the vapor condenses. Once the vapor condenses, it provides a latent heating term, and the condensed water is removed immediately to the surface as large-scale rainfall, and thus the model needs no cloud or rain variables. The parameterization includes the important first-order effect of latent heating in areas of saturated large-scale ascent, such as often occurs with frontal or orographic lifting.

2.4 Kessler microphysics

An alternative to large-scale condensation is a simple microphysics scheme that includes cloud and rain 3d arrays. This enables more sophisticated data assimilation related to reflectivity, for example. The parameterization includes no ice phase, but is adequate for representing storm-scale circulations where these are resolved because the major effects of latent heating in updrafts and precipitation evaporation are captured by this scheme. The scheme would also be adequate for large-scale stratus clouds, and cloud-topped boundary layers. In addition to the condensation and evaporation of cloud water at 100% relative humidity, the growth of cloud droplets to rain drops, the fall and evaporation of rain, and the accretion of cloud by rain drops are parameterized in the Kessler scheme.


