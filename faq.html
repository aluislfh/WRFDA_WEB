<html>

<head>

<title>WRFDA USER SUPPORT: Frequently Asked Questions</title>

<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">

<meta name="KEYWORDS" content="meteorology, mesoscale, microscale, weather modeling, forecasting weather, weather prediction, predictability, cloud systems, boundary layers, surface-atmosphere interactions, convective cloud systems, atmospheric chemistry, precipitating weather systems, wildfire research, National Center for Atmospheric Research">

<meta name="DESCRIPTION" content="WRF Mesoscale Model Users homepage">

<meta name="ROBOTS" content="INDEX,FOLLOW">

<meta name="resource-type" content="document">

<meta http-equiv="expires" content="0">

<meta name="author" content="MMM Webmaster">

<meta name="copyright" content="Copyright (c) 2017 by UCAR">

<meta name="revisit-after" content="1 days">

<meta name="distribution" content="Global">

<meta name="rating" content="General">





<SCRIPT language=JavaScript src="scripts/menu_array.js" type=text/javascript></SCRIPT>

<SCRIPT language=JavaScript src="scripts/mmenu.js" type=text/javascript></SCRIPT>





<link href="images/wrfstyle.css" rel="stylesheet" type="text/css">



</head>



<body bgcolor="#FFFFFF" link="#000099" vlink="#000099" alink="#FF3300" leftmargin="0" topmargin="0" marginwidth="0" marginheight="0">

<table width="100%" border="0" cellspacing="0" cellpadding="0">

  <tr bgcolor="#000000">

    <td height="10" bgcolor="#000000"><div align="left"><img src="images/transgif.gif" width="1" height="1"></div>

    </td>

  </tr>

  <tr valign="top">

    <td height="10" bgcolor="#DDFFDD"><img src="images/header_new_cropped.png" height="56" border="0"></td>

  </tr>

  <tr bgcolor="#FFCC33">

    <td height="6" background="images/goldrule.jpg" bgcolor="#009933"><img src="images/goldrule.jpg" width="1" height="1"></td>

  </tr>

  <tr>

    <td height="34" bgcolor="#009933">&nbsp;</td>

  </tr>

  <tr>

    <td height="2" bgcolor="#ffcc66"><img src="images/transgif.gif" width="1" height="1"></td>

  </tr>

</table>

<table width="100%" height="91%" border="0" cellpadding="0" cellspacing="0" class="background">

  <tr>

    <td height="863" valign="top" bgcolor="#CBFFCD"><table width="100%" border="0" cellpadding="0" cellspacing="0">

      <tr valign="top">

        <td width="117" height="900" bgcolor="#009933"><p>&nbsp;</p>

          <table width="117" border="0" align="center" cellpadding="0" cellspacing="0">

            <tr> 
              <p align="center"><a href="support.html" class="leftnavlink">WRFDA community support</a></p>
              <p align="center" style="border-width: 5px;border-style: solid;border-color: #CBFFCD;background-color: #CBFFCD;font-family: Arial; line-height: 10pt; font-weight: bold;">Frequently asked questions</p>
              <p align="center"><a href="known-prob.html" class="leftnavlink">Known problems and solutions</a></p>
              <p align="center"><a href="requirements.html" class="leftnavlink">System requirements</a></p>
              <p align="center"><a href="wrfhelp.html" class="leftnavlink">About wrfhelp</a></p>
              <p align="center"><a href="wrfnews.html" class="leftnavlink">wrf-news list</a></p>
              <p align="center"><a href="wrfusers.html" class="leftnavlink">wrf-users list</a></p>
              <p align="center"><a href="regist.html" class="leftnavlink">Becoming a registered user</a></p>
              <p align="center"><a href="workshop.html" class="leftnavlink">WRF Workshop</a></p>
              <p align="center"><a href="tutorial.html" class="leftnavlink">WRFDA Tutorials</a></p>
              <p align="center"><a href="usersguide.html" class="leftnavlink">Users' Guide</a></p>
            </tr>
          </table>

          <p>&nbsp;</p>          <p>&nbsp;</p>            <img src="images/shim112.gif" width="112" height="1"></td>

          <td bgcolor="#CBFFCD"><p>&nbsp;</p>

            <p class="pagetitle">WRFDA User Support: Frequently Asked Questions</p>
            <p class="bodytext"><em>Note: be sure to check the <a href="known-problems.html">Known Problems page</a> if you are experiencing an error not listed here.</em></p>
            <blockquote>
              <ul class="bodytext"><li><a href="#links">Quick links</a></li>
              <li><a href="#general">General questions</a></li>
              <li><a href="#compiling">Compiling WRFDA</a></li>
              <li><a href="#running">Running WRFDA</a></li>
              <li><a href="#be">Background error and GEN_BE</a></li>
              <li><a href="#obs">Observations and OBSPROC</a></li>
              <li><a href="#out">WRFDA output</a></li>
              <li><a href="#cycling">Cycling WRF and WRFDA</a></li>
              </ul><br></blockquote>

            <blockquote>
              <h1><a name="links">Quick links</h1>
                <b><ul class="bodytext"><br><li><a href="downloads.html">Download WRFDA</a></li>
                <li><a href="known-problems.html">Known problems and solutions</a></li>
                <li><a href="usersguide.html">User's Guide</a></ul></b><br>

              <h1><a name="general">General WRFDA questions</h1>
            </blockquote>

            <p style="padding-left: 45px;"><table width="96%" border="1" align="center" bordercolor="#FF8A81" bgcolor="#FFFFFF" class="font11" style="background-color:#DDFFDD;">
              <tr>
                <td width="5%"><a name=general_q1><strong>Q1</strong></td>
                <td class="font11"><strong>What is WRFDA?</strong></td>
              </tr>
              <tr>
                <td style="color:#900"><strong>A1</strong></td>
                <td style="color:#900"><b>WRFDA</b> is a <b>D</b>ata <b>A</b>ssimilation system for the <b>W</b>eather <b>R</b>esearch and <b>F</b>orecasting model. <a href=http://www2.mmm.ucar.edu/wrf/users/>You can learn more about the WRF model here</a>. Data assimilation is the process of combining observations with computer model information to come up with a "best guess" of the state of the system: in this case, the atmosphere. Ultimately, the goal of atmospheric data assimilation is usually to improve a subsequent weather model forecast.</td>
              </tr>
              <tr>
                <td width="5%"><a name=general_q2><strong>Q2</strong></td>
                <td class="font11"><strong>What does WRFDA do?</strong></td>
              </tr>
              <tr>
                <td style="color:#900"><strong>A2</strong></td>
                <td style="color:#900">WRFDA takes a "first guess" of the atmospheric state (either a WRF input file or WRF forecast output file), observations, and information about the uncertainty/error statistics of both, and produces a "best guess" based on all the input information. This output file can then either be analyzed on its own, or used to initiate a new WRF forecast.</td>
              </tr>            
              <tr>
                <td width="5%"><a name=general_q3><strong>Q3</strong></td>
                <td class="font11"><strong>What are the system requirements for running WRFDA?</strong></td>
              </tr>
              <tr>
                <td style="color:#900"><strong>A3</strong></td>
                <td style="color:#900">WRFDA is designed to be highly scalable and versatile, so depending on your case the system requirements will vary greatly. There are some known minimum requirements, which are listed at the  <a href="requirements.html">system requirements page</a>.</td>
              </tr>
            </table></p>



            <blockquote>
              <h1><a name="running">Running WRFDA</h1>
            </blockquote>

            <p style="padding-left: 45px;"><table width="96%" border="1" align="center" bordercolor="#FF8A81" bgcolor="#FFFFFF" class="font11" style="background-color:#DDFFDD;">
              <tr>
                <td width="5%"><a name=running_q1><strong>Q1</strong></td>
                <td class="font11"><strong>When I try to run WRFDA I get an error: "ERRORS while reading one or more namelists from namelist.input". How can I fix this?</strong></td>
              </tr>
              <tr>
                <td style="color:#900"><strong>A1</strong></td>
                <td style="color:#900">This error indicates that WRFDA had a problem reading one or more sections of your <code>namelist.input</code> file. Typically this is because an invalid namelist option was specified, or the option name was misspelled. Usually the error message will also state which namelist section had a problem (for example, "ERROR while reading namelist wrfvar4"), so check every namelist option in that section to make sure it is valid. See the <a href="usersguide.html">User's Guide</a> specific to your version; there is a section at the end listing valid namelist options.<br>
                  The second most common reason for this error is a missing "/" at the end of a namelist section. Namelist sections must begin with a line specifying the section name (for example, "&amp;wrfvar1"), and end with a line containing the "/" character, indicating the end of the namelist section. A short example can be found below:<br><br>
                  <kbd>&nbsp;&amp;wrfvar1<br>
                    &nbsp; &nbsp;var4d                                = .false.,<br>
                    &nbsp; &nbsp;print_detail_grad                    = .true.,<br>
                    &nbsp;/<br><br></kbd>
                  See <a href=http://www2.mmm.ucar.edu/wrf/users/wrfda/usersguide.html>the Users Guide</a> for more details. An example namelist can also be found in the source code, under <kbd>WRFDA/var/test/tutorial/namelist.input</kbd>
                </td>
              </tr>
              <tr>
                <td width="5%"><a name=running_q2><strong>Q2</strong></td>
                <td class="font11"><strong>When I try to run WRFDA I get an error: "Missing or invalid AS1 ~ AS5 value for IT =        2". How can I fix this?</strong></td>
              </tr>
              <tr>
                <td style="color:#900"><strong>A2</strong></td>
                <td style="color:#900">This error is encountered when you attempt to use multiple outer loops in your minimization with the CV3 background error option. By default, WRFDA only has CV3 length and variance scaling parameters set for a single outer loop; for multiple outer loops you need to set these parameters manually in the namelist. See the section in the user's guide on "<a href="Docs/user_guide_V3.8/users_guide_chap6.htm#CV3">Modifying CV3 length scales and variance</a>" for information on how to do this.</td>
              </tr>
              <tr>
                <td width="5%"><a name=running_q3><strong>Q3</strong></td>
                <td class="font11"><strong>My WRFDA-4DVAR runs fail with a segmentation fault, "signal 9" error, or no error at all. What is the problem?</strong></td>
              </tr>
              <tr>
                <td style="color:#900"><strong>A3</strong></td>
                <td style="color:#900">The most common cause of failure for 4DVAR runs is running out of memory. This is because WRFDA must store the entire run of the nonlinear WRF model in memory (the first step of the minimization). The solution is to either add more nodes (if on a cluster), or if that is not possible, to reduce your memory footprint in one or more of the following ways:<br>
                <ul><li>Use a smaller domain</li>
                  <li>Use the same domain but a lower resolution (which would allow for less gridpoints and a larger time step)</li>
                  <li>Use a smaller assimilation window</li>
                  <li>Use a simple microphysics option for your WRFNL run, set by the namelist option "mp_physics". You can use a different microphysics option than you plan to use with WRF</li>
                </ul></td>
              </tr>
              <tr>
                <td width="5%"><a name=running_q4><strong>Q4</strong></td>
                <td class="font11"><strong>I see one or more warning messages like this in my output, should I be worried?</strong><br>
                <code>--------------------------- WARNING ---------------------------<br>
                      WARNING FROM FILE: <A HREF="http://www.mmm.ucar.edu/people/wrfhelp/wrfvar/code/trunk/da_scan_obs_ascii.html">da_scan_obs_ascii.inc</a>  LINE:      61<br>
                      Error   29 opening gts obs file ob01.ascii</code></td>
              </tr>
              <tr>
                <td style="color:#900"><strong>A4</strong></td>
                <td style="color:#900">WRFDA will always look for a conventional observation file, either "ob.ascii" (if ob_format=2 in your namelist) or "ob.bufr" (ob_format=1). For 4DVAR, there will be multiple files: one for each timeslot for ob_format=2 (ob01.ascii, ob02.ascii, ob03.ascii, etc.) or as many consecutive 6-hour-spanning files as are needed for ob_format=1 PREPBUFR files (ob01.bufr, ob02.bufr, etc.). All of these files are optional, so if you are aware that these files are missing, you can ignore the above-mentioned warning.</td>
              </tr>

            </table></p>

            <blockquote>
              <h1><a name="running_GENBE"><a name=be>Background error and GEN_BE</h1>
            </blockquote>
            <p style="padding-left: 45px;"><table width="96%" border="1" align="center" bordercolor="#FF8A81" bgcolor="#FFFFFF" class="font11" style="background-color:#DDFFDD;">
              <tr>
                <td width="5%"><a name=be_q1><strong>Q1</strong></td>
                <td class="font11"><strong>When running GEN_BE, it fails with the message "Stage gen_be_diags failed with error". How can I fix this?</strong></td>
              </tr>
              <tr>
                <td style="color:#900"><strong>A1</strong></td>
                <td style="color:#900">While this error message states that the failure was in "Stage gen_be_diags", this is almost always due to an error at an earlier stage. Look in the log files for stages 0&ndash;4 for more information.<br>The most common errors are as follows:
                  <ul><li><b>error 2</b> usually indicates incorrect specification of "NUM_LEVELS" (should be equal to e_vert - 1)</li>
                  <li><b>error 24</b> usually indicates incorrect setup of your WRF forecast directories. See the <a href=#be_q2>entry below</a> for help on setting up your GEN_BE forecasts properly.</li>
                </td>
              </tr>
              <tr>
                <td width="5%"><a name=be_q2><strong>Q2</strong></td>
                <td class="font11"><strong>How do I set up my WRF forecasts as input for GEN_BE?</strong></td>
              </tr>
              <tr>
                <td style="color:#900"><strong>A2</strong></td>
                <td style="color:#900">In the WRFDA package, there is a script <kbd>var/scripts/gen_be/gen_be_wrapper.ksh</kbd>, which is used to run the GEN_BE utility as described in the <a href=../../../usersguide.html>user's guide</a>. In that script, you are instructed to set a variable "FC_DIR", which is labelled as "where wrf forecasts are": an admittedly unhelpful label.<br><br> 
                  GEN_BE uses the so-called "NMC method", where forecasts that are valid for the same date/time but initialized at different times are compared, to find an approximation of the background error (<a href=http://journals.ametsoc.org/doi/abs/10.1175/1520-0493%281992%29120%3C1747%3ATNMCSS%3E2.0.CO%3B2>Parrish and Derber, 1992</a>). GEN_BE compares a number of sequential forecasts using this method. The default setup in <kbd>gen_be_wrapper.ksh</kbd> is a "24-12" NMC comparison, which compares a 24-hour forecast with a 12-hour forecast (FCST_RANGE1=24, FCST_RANGE2=12).<br><br>
                  Let's say that we use <kbd>/user/home/genbe/forecasts/</kbd> as our FC_DIR. If we are running from START_DATE=2012091200 to END_DATE=2012091900, we will need to have the following subdirectories within that directory:<br><br>
                  <code>&nbsp; $ ls /user/home/genbe/forecasts/<br>
                    &nbsp; 2012091100  2012091300  2012091500  2012091700  2012091900<br>
                    &nbsp; 2012091112  2012091312  2012091512  2012091712  2012091912<br>
                    &nbsp; 2012091200  2012091400  2012091600  2012091800<br>
                    &nbsp; 2012091212  2012091412  2012091612  2012091812<br><br></code>
                  Within each of those directories should be the WRF output files from a forecast initialized <b>at that time</b>. In other words, <em>each directory should have the output from a different forecast: you can not use one single, long forecast split into different directories</em>. So the directory /user/home/genbe/forecasts/2012091200/ should have the 12-hour and 24-hour forecast files like this:<br><br>
                  <code>$ ls /user/home/genbe/forecasts/2012091200<br>
                    wrfout_d01_2012-09-12_12:00:00  wrfout_d01_2012-09-13_00:00:00<br><br></code>
                  and the directory /user/home/genbe/forecasts/2012091212/should have the 12-hour and 24-hour forecast files like this:<br> 
                  <code>$ ls /user/home/genbe/forecasts/2012091212<br><br>
                    wrfout_d01_2012-09-13_00:00:00  wrfout_d01_2012-09-13_12:00:00<br><br></code>
                  and so on. GEN_BE will be comparing 2012091200/wrfout_d01_2012-09-13_00:00:00 to 2012091212/wrfout_d01_2012-09-13_00:00:00, 2012091212/wrfout_d01_2012-09-13_12:00:00 to 2012091300/wrfout_d01_2012-09-13_12:00:00, 2012091200/wrfout_d01_2012-09-13_00:00:00 to 2012091212/wrfout_d01_2012-09-13_00:00:00, and so on.<br><br>
                  The one-week period above is just an example: for guidance on how many forecasts you will need, see the next entry below.<br>
                </td>
              </tr>
              <tr>
                <td width="5%"><a name=be_q3><strong>Q3</strong></td>
                <td class="font11"><strong>How many forecasts are necessary for getting good background error statistics from GEN_BE? Do I need to continuously update by background error?</strong></td>
              </tr>
              <tr>
                <td style="color:#900"><strong>A3</strong></td>
                <td style="color:#900">The number of forecasts necessary to "train" your background error properly will vary depending on your application, but a two-week period of forecasts at 12-hour intervals (25 forecasts in total) should be considered a bare minimum for scientific purposes. <br><br>
                  Additionally, since the calculated background error can depend strongly on the exact weather regime found in those forecasts, you should use forecasts from a similar season that you plan on running WRFDA. For example, if you are running a data assimilation experiment on a July case using a be.dat background error file calculated from January forecasts, you may get poor results!<br><br>
                  As a real-world example: The Antarctic Mesoscale Prediction System (<a href=http://www2.mmm.ucar.edu/rt/amps/>AMPS</a>), which uses WRFDA, recalculates their background error each month, using the previous month of forecasts from their system as the input to GEN_BE.<br>
                </td>
              </tr>
            </table></p>

            <blockquote>
              <h1><a name="obs">Observations and OBSPROC</h1>
            </blockquote>

            <p style="padding-left: 45px;"><table width="96%" border="1" align="center" bordercolor="#FF8A81" bgcolor="#FFFFFF" class="font11" style="background-color:#DDFFDD;">
              <tr>
                <td width="5%"><a name=obs_q1><strong>Q1</strong></td>
                <td><strong>Can my observations be assimilated in WRFDA?</strong></td>
              </tr>
              <tr>
                <td style="color:#900"><strong>A2</strong></td>
                <td style="color:#900">WRFDA is able to assimilate many different types of data, which are listed at <a href="system.html#methods_and_obs">this page</a>.<br>
                  WRFDA can assimilate conventional observations in several formats:
                  <ul><li>LITTLE_R (text-based format) through the OBSPROC utility</li>
                      <li>NCEP PREPBUFR (binary format)</li>
                      <li>MADIS (netCDF format), through the <a href="download/madis.html">MADIS2LITTLER</a> converter</li></ul>
                  Other types of observations are assimilated in their own formats:
                  <ul><li>Radiance data (AMSU, HIRS, IASI, etc.) are assimilated in BUFR format.</li>
                      <li>Precipitation data is assimilated in a text format similar to LITTLE_R. <a href="download/precip_converter.tar.gz">A converter is provided</a> for converting NCEP Stage IV data into this text format.</li>
                      <li>Radar data is assimilated in yet another text format.</li></ul>
                  If your observations are not in one of the formats listed above, you must convert them into one of the supported formats. LITTLE_R is likely the easiest.<br>
                  See the <a href="usersguide.html">User's Guide</a> for more detailed information.
                </td>
              </tr>
            </table></p>

            <blockquote>
              <h1><a name="out">WRFDA output</h1>
            </blockquote>

            <p style="padding-left: 45px;"><table width="96%" border="1" align="center" bordercolor="#FF8A81" bgcolor="#FFFFFF" class="font11" style="background-color:#DDFFDD;">
              <tr>
                <td width="5%"><a name=out_q1><strong>Q1</strong></td>
                <td><strong>I didn't get a wrfvar_output file. What went wrong?</strong></td>
              </tr>
              <tr>
                <td style="color:#900"><strong>A1</strong></td>
                <td style="color:#900">WRFDA prints out a lot of log information while it runs, including error messages if something went wrong. If you ran the program with MPI (dmpar&ndash;distributed memory parallelism), these log messages can be found in two sets of files: <kbd>rsl.out.0000</kbd>,<kbd>rsl.out.0001</kbd>, etc. (one log file for each processor you used) and <kbd>rsl.error.0000</kbd>, <kbd>rsl.error.0001</kbd>, etc. (one error file for each processor you used). If you did not get a wrfvar_output file, you should look in the <kbd>rsl.out.*</kbd> and <kbd>rsl.error.*</kbd> files for any error messages. Often the error message will be descriptive (missing input file, bad namelist setting, etc.) and you should be able to resolve the problem. Sometimes the program just quits with a segmentation fault or something similar; see <a href=#running_q3>this Q&A entry for more info</a>.
                </td>
              </tr>
            </table></p>

            <blockquote>
              <h1><a name="cycling">Cycling WRF and WRFDA</h1>
            </blockquote>

            <p style="padding-left: 45px;"><table width="96%" border="1" align="center" bordercolor="#FF8A81" bgcolor="#FFFFFF" class="font11" style="background-color:#DDFFDD;">
              <tr>
                <td width="5%"><a name=cycling_q1><strong>Q1</strong></td>
                <td><strong>What is "cycling" exactly? How do I set up cycling for WRF and WRFDA?</strong></td>
              </tr>
              <tr>
                <td style="color:#900"><strong>A1</strong></td>
                <td style="color:#900">"Cycling" is the process by which the output of a previous WRF forecast is used to initialize a new WRF forecast, rather than taking the initial conditions from some other analysis/forecast through WPS/real. This is usually done in the context of real-time forecast
                  You can find detailed instructions on cycling with WRF/WRFDA in the <a href=http://www2.mmm.ucar.edu/wrf/users/wrfda/Docs/user_guide_V3.9/users_guide_chap6.htm#_Cycling_with_WRF_1</a>relevant section of the Users Guide</a>
                </td>
              </tr>
              <tr>
                <td width="5%"><a name=cycling_q2><strong>Q2</strong></td>
                <td><strong>What is the difference between "warm-start" and "cold-start" forecasts?</strong></td>
              </tr>
              <tr>
                <td style="color:#900"><strong>A2</strong></td>
                <td style="color:#900">These terms are widely used in the field of atmospheric modeling and data assimilation, however, to quote <a href=http://www.oc.nps.edu/nom/modeling/initial.html>this site from the Naval Postgraduate School</a>, "The terms <em>cold start</em> and <em>warm start</em> may mean slightly different things to different people." In the context of WRF and WRFDA, a "cold-start" forecast is when the first guess (<kbd>fg</kbd>) file provided to WRFDA is a <kbd>wrfinput</kbd> file from WPS/real, while a "warm-start" forecast is one where the first guess is a WRF forecast file (<kbd>wrfout</kbd>).<br>
                  Because of the ambiguity in what constitutes a cold-start or warm-start, we try to avoid using these terms in the official documentation.
                </td>
              </tr>
            </table></p>


            <blockquote>

              <blockquote>&nbsp;</blockquote>
            </blockquote>                        

            <p align="center" class="detailtextRed">

              <script language="JavaScript">

<!--

document.write("updated " + document.lastModified);

// -->

                        </script>
</p>

            <p class="bodytext">&nbsp;            </p>            <br>

            <br>        <img src="images/transgif.gif" width="1" height="1"><img src="images/shim162.gif" width="162" height="1"></td>
        </tr>


    </table></td>

    <td width="117" height="900" bgcolor="#CBFFCD"><p>&nbsp;</p>

  </tr>

  <tr>

    <td colspan=2 height="50" bgcolor="#009933" class="detailtext">&nbsp;</td>
  </tr>
</table>

</body>

</html>

