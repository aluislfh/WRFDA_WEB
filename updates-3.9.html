<html>

<head>

<title>WRFDA Updates for 3.9</title>

<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">

<meta name="KEYWORDS" content="meteorology, mesoscale, microscale, weather modeling, forecasting weather, weather prediction, predictability, cloud systems, boundary layers, surface-atmosphere interactions, convective cloud systems, atmospheric chemistry, precipitating weather systems, wildfire research, National Center for Atmospheric Research">

<meta name="DESCRIPTION" content="WRF Data Assimilation Users homepage">

<meta name="ROBOTS" content="INDEX,FOLLOW">

<meta name="resource-type" content="document">

<meta http-equiv="expires" content="0">

<meta name="author" content="MMM Webmaster">

<meta name="copyright" content="Copyright (c) 2017 by UCAR">

<meta name="revisit-after" content="1 days">

<meta name="distribution" content="Global">

<meta name="rating" content="General">





<SCRIPT language=JavaScript src="./scripts/menu_array.js" type=text/javascript></SCRIPT>

<SCRIPT language=JavaScript src="./scripts/mmenu.js" type=text/javascript></SCRIPT>





<link href="./images/wrfstyle.css" rel="stylesheet" type="text/css">

</head>



<body bgcolor="#FFFFFF" background="./images/back2.jpg" link="#000099" vlink="#000099" alink="#FF3300" leftmargin="0" topmargin="0" marginwidth="0" marginheight="0">

<table width="100%" border="0" cellspacing="0" cellpadding="0">

  <tr bgcolor="#000000">

    <td height="10" bgcolor="#000000"><div align="left"><img src="images/transgif.gif" width="1" height="1"></div>

    </td>

  </tr>

  <tr valign="top">

    <td height="10" bgcolor="#DDFFDD"><img src="images/header_new_cropped.png" height="56" border="0"></td>

  </tr>

  <tr bgcolor="#FFCC33">

    <td height="6" background="./images/goldrule.jpg"><img src="images/goldrule.jpg" width="1" height="1"></td>

  </tr>

  <tr>

    <td height="34" bgcolor="#009933">&nbsp;</td>

  </tr>

  <tr>

    <td height="2" bgcolor="#ffcc66"><img src="images/transgif.gif" width="1" height="1"></td>

  </tr>

</table>

<table width="100%" height="89%" border="0" cellpadding="0" cellspacing="0" class="background">

  <tr>

    <td width="100%" height="838" valign="top" bgcolor="#CBFFCD"><table width="780" border="0" cellpadding="0" cellspacing="0">

      <tr valign="top">
        <td height="842" bgcolor="#009933"><p align="right">&nbsp;</p>
           <p align="center"><a href="system.html" class="leftnavlink">System Overview</a></p>
           <p align="center" style="border-width: 5px;border-style: solid;border-color: #CBFFCD;background-color: #CBFFCD;font-family: Arial; line-height: 10pt;font-weight: bold;">WRFDA V3.9</p>
           <p align="center"><a href="updates-3.8.1.html" class="leftnavlink">WRFDA V3.8.1</a></p>
           <p align="center"><a href="updates-3.8.html" class="leftnavlink">WRFDA V3.8</a></p>
           <p align="center"><a href="updates-3.7.1.html" class="leftnavlink">WRFDA V3.7.1</a></p>
           <p align="center"><a href="updates-3.7.html" class="leftnavlink">WRFDA V3.7</a></p>
           <p align="center"><a href="updates-3.6.1.html" class="leftnavlink">WRFDA V3.6.1</a></p>
           <p align="center"><a href="updates-3.6.html" class="leftnavlink">WRFDA V3.6</a></p>
           <p align="center"><a href="updates-3.5.1.html" class="leftnavlink">WRFDA V3.5.1</a></p>
           <p align="center"><a href="updates-3.5.0.1.html" class="leftnavlink">WRFDA V3.5.0.1</a></p>
           <p align="center"><a href="updates-3.5.html" class="leftnavlink">WRFDA V3.5</a></p>
           <p align="center"><a href="updates-3.4.1.html" class="leftnavlink">WRFDA V3.4.1</a></p>
           <p align="center"><a href="updates-3.4.html" class="leftnavlink">WRFDA V3.4</a></p>
           <p align="center"><a href="updates-older.html" class="leftnavlink">Older versions</a></p>
           <p align="center"><a href="tutorial.html" class="leftnavlink">Tutorials</a></p>
           <p align="center"><a href="download/tools.html" class="leftnavlink">Tools</a></p>
           <p align="center"><a href="known-problems.html" class="leftnavlink">Known Problems and Fixes</a></p></td>
        <td width="663" bgcolor="#CBFFCD"><p>&nbsp;</p>
            <p class="pagetitle">WRFDA Version 3.9 update summary</p>
            <blockquote>
              <h2>WRFDA Version 3.9 was released on April 17, 2017. </h2>
              <h3><big>New features:</big></h3>
              <ul class="bodytext"><li>WRFDA now supports <a href="#4denvar">a 4DEnVar assimilation option</a>.</li>
                <li><a href="#cloudyrad">Cloudy radiances</a> can now be assimilated for the AMSR2 instrument.</li>
                <li><a href="#nullecho">Null-echo radar observations</a> can now be assimilated.</li>
                <li><a href="#synop">New run-time options</a> for improving surface data assimilation (FM-12 SYNOP).</li>
                <li><a href="#cloudbasehgt">New run-time options</a> for calculating cloud base height for use_radar_rqv=true.</li>
              </ul>

              <h3><big>Updated features:</big></h3>
              <ul class="bodytext"><li>The use_radar_rhv=true option for radar assimilation has undergone a major update, including major bug fixes. <b>Users of this capability should upgrate to WRFDA 3.9, since the older release code produces incorrect results.</b> The fixes include:</li>
                  <ul class="bodytext"><li>Fixed total reflectivity calculations</li>
                  <li>Fixed coefficients for computing retrieved hydrometeors</li>
                  <li>Fixed error specification for snow hydrometeors</li></ul>
                <li>Updated CRTM to version 2.2.3 (from 2.1.3)</li>
                <li>For 4DVAR runs, mp_physics under &physics in the namelist now must be specified, or WRFDA will fail. Previously this defaulted to mp_physics=0 (no physics)</li>
                <li>Bug fixes and performance improvements:</li>
                  <ul class="bodytext"><li>Fixed incorrect summing of “rgr” (graupel) values for radar observations in “statistics” file</li>
                  <li>Fixed VARBC failures for when CRTM-calculated pressure does not increase monotonically</li>
                  <li>Fixed runtime errors when attempting to assimilate more than one observation file for IASI and SEVIRI radiance assimilation</li>
                  <li>Fixed runtime errors when attempting to assimilate observations with large numbers of vertical levels</li>
                  <li>Fixed duplicate calls to adjoint and tangent linear models for 4DVAR with calculate_cg_cost_fn=true, unnecessarily doubling runtime.</li>
                  <li>Fixed several bugs for PGI, both for compilation and runtime</li> 
                  <li>Fixed assimilation of some types of pseudo observations with multiple processors</li> 
                  <li>For use_radar_rf=true, critical minimum value was set too high</li>
                  <li>Fixed discontinuities when using dual-resolution hybrid with 5:1 parent:nest ratio</li>
                  <li>Fixed problem with single-level GPSREF observations above 30km</li>
                </ul> 
                <li><a href="download/wrfplus.html">WRFPLUS</a> (WRF adjoint and tangent linear model) has been upgraded to V3.9 and is consistent with the released WRF version 3.9.</li></ul>
              <p class="bodytext">For instructions on compiling and running the latest version of WRFDA, please refer to the updated <a href="Docs/user_guide_V3.9/WRFDA_Users_Guide.html">User's Guide</a></p>

            </blockquote>
            <p class="pagetitle">Version 3.9 update details</p>
            <blockquote>
              <a name="4denvar">
              <h1>4-Dimensional Ensemble&endash;Variational (4DEnVar) data assimilation option</h1>
              <p class="bodytext">Prior to version 3.9, WRFDA supported a 3DEnVar data assimilation option. For Version 3.9, the capability for 4DEnVar assimilation has been added. The procedure for 4DEnVar is very similar to the procedure for 3DEnVar. Unlike 4DVAR, 4DEnVar does not require WRFPLUS, the tangent linear/adjoint model. It is more analogous to the First Guess at Appropriate Time (FGAT) method than full 4DVAR. Like FGAT, 4DEnVar requires multiple first guess files, one for each assimilation time window. In addition, you must have ensemble output for each of the first guess times, and generate ensemble perturbations from each of these sets of ensemble forecasts.</p>

              <p class="bodytext">To activate the 4DEnVar option, set the namelist variable <code>use_4denvar=.true.</code> See <a href="./Docs/user_guide_V3.9/users_guide_chap6.htm#_Running_the_hybrid_1">the users guide</a> for full details about this capability. A tutorial case with a test ensemble can be found <a href="wrfda/download/V39/WRFDA_4denvar_test_data.tar.gz">here</a>. In this example, the ensemble forecasts were initialized at 2005071512 and valid for 2005071521—2005071603. The 4DEnVar hybrid analysis (wrfvar_output) will be valid for 2005071600.</p>

              <p>&nbsp;</p>

            </blockquote>
            <p class="pagetitle">Helpful links</p>
            <blockquote>
              <li class="bodytext"><big><a href="./Docs/user_guide_V3.9/users_guide_chap6.htm#_Installing_WRF-Var">Compiling WRFDA</a></big></li>
              <li class="bodytext"><big><a href="./Docs/user_guide_V3.9/users_guide_chap6.htm#_Running_WRF-Var_1">Running WRFDA</a></big></li>
              <li class="bodytext"><big><a href="./Docs/user_guide_V3.9/users_guide_chap6.htm#_Description_of_Namelist_2">List and description of namelist variables</a></big></li>

              <p class="bodytext"><br></p>
              <p align="center" class="detailtextRed"><br>
                <script language="JavaScript"><!--  ;;;;;;;;;;;-->

<!--

document.write("updated " + document.lastModified);

// -->

                        </script><br><br>&nbsp;
              </p>
              <p>&nbsp;</p>
          </blockquote>            </td>
        </tr>

    </table></td>
  </tr>

  <tr>

    <td height="50" bgcolor="#009933" class="detailtext">&nbsp;</td>
  </tr>
</table>

</body>

</html>

